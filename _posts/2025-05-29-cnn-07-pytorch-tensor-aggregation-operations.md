---
title: "(CNN) PyTorch Tensor ì§‘ê³„ ì—°ì‚°"
description: ""sum, min, max, meanê³¼ argmaxë¥¼ í™œìš©í•œ ë°ì´í„° ì§‘ê³„""
date: 2025-05-29 10:00:00 +0900
categories: [Dev, CNN]
tags: [pytorch, tensor, aggregation, sum, mean, max, min, argmax, deep learning]
---

-------------------------------------------------------

# PyTorch í…ì„œ ì§‘ê³„ ì—°ì‚°

* ìµœì´ˆ ì‘ì„±ì¼: 2025ë…„ 5ì›” 29ì¼ (ëª©)

## ëª©ì°¨

1. [ì§‘ê³„ ì—°ì‚°ì˜ ì´í•´](#ì§‘ê³„-ì—°ì‚°ì˜-ì´í•´)
2. [ê¸°ë³¸ ì§‘ê³„ í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸°](#ê¸°ë³¸-ì§‘ê³„-í•¨ìˆ˜-ì‚¬ìš©í•˜ê¸°)
3. [ì°¨ì›ë³„ ì§‘ê³„ ì—°ì‚°](#ì°¨ì›ë³„-ì§‘ê³„-ì—°ì‚°)
4. [ë‹¤ì¤‘ ì°¨ì› ì§‘ê³„](#ë‹¤ì¤‘-ì°¨ì›-ì§‘ê³„)
5. [argmaxì™€ argmin í™œìš©](#argmaxì™€-argmin-í™œìš©)
6. [ì‹¤ì „ í™œìš© ì˜ˆì œ](#ì‹¤ì „-í™œìš©-ì˜ˆì œ)

---

## ğŸ“Š ì§‘ê³„ ì—°ì‚°ì˜ ì´í•´

ì§‘ê³„(aggregation) ì—°ì‚°ì€ í…ì„œì˜ ì—¬ëŸ¬ ê°’ì„ í•˜ë‚˜ ë˜ëŠ” ë” ì ì€ ìˆ˜ì˜ ê°’ìœ¼ë¡œ ìš”ì•½í•˜ëŠ” í•µì‹¬ ì—°ì‚°ì´ë‹¤. ë”¥ëŸ¬ë‹ì—ì„œëŠ” ì†ì‹¤ ê³„ì‚°, í†µê³„ ë¶„ì„, íŠ¹ì§• ì¶”ì¶œ ë“±ì— í•„ìˆ˜ì ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤.

### ì£¼ìš” ì§‘ê³„ í•¨ìˆ˜
- **sum**: ì›ì†Œë“¤ì˜ í•©
- **mean**: í‰ê· ê°’
- **max/min**: ìµœëŒ€/ìµœì†Œê°’
- **std/var**: í‘œì¤€í¸ì°¨/ë¶„ì‚°
- **argmax/argmin**: ìµœëŒ€/ìµœì†Œê°’ì˜ ì¸ë±ìŠ¤

```python
import torch

# ê°„ë‹¨í•œ 1D í…ì„œë¡œ ì‹œì‘
scores = torch.tensor([85.5, 92.3, 78.9, 95.1, 88.7])
print(f"í•™ìƒ ì ìˆ˜: {scores}")
# ì¶œë ¥: í•™ìƒ ì ìˆ˜: tensor([85.5000, 92.3000, 78.9000, 95.1000, 88.7000])

print(f"ì´ì : {scores.sum():.1f}")
# ì¶œë ¥: ì´ì : 440.5

print(f"í‰ê· : {scores.mean():.1f}")
# ì¶œë ¥: í‰ê· : 88.1

print(f"ìµœê³ ì : {scores.max():.1f}")
# ì¶œë ¥: ìµœê³ ì : 95.1

print(f"ìµœì €ì : {scores.min():.1f}")
# ì¶œë ¥: ìµœì €ì : 78.9
```

<br/>

<div align="center">
  <img src="https://github.com/user-attachments/assets/86930e98-093b-4e23-bab6-d36e1644a311" width="1800">
</div>

---

## ğŸ”¢ ê¸°ë³¸ ì§‘ê³„ í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸°

### 2D í…ì„œì—ì„œì˜ ì „ì²´ ì§‘ê³„
```python
# 2D ì„±ì í‘œ: 5ëª… í•™ìƒ x 3ê³¼ëª©
grades = torch.tensor([
    [85, 90, 88],  # í•™ìƒ 1
    [92, 88, 95],  # í•™ìƒ 2
    [78, 85, 82],  # í•™ìƒ 3
    [90, 92, 91],  # í•™ìƒ 4
    [88, 86, 89]   # í•™ìƒ 5
], dtype=torch.float32)

print("ì„±ì í‘œ:")
print(grades)
# ì¶œë ¥: ì„±ì í‘œ:
#       tensor([[85., 90., 88.],
#               [92., 88., 95.],
#               [78., 85., 82.],
#               [90., 92., 91.],
#               [88., 86., 89.]])

# ì „ì²´ ì›ì†Œì— ëŒ€í•œ ì§‘ê³„
print(f"ì „ì²´ í‰ê· : {grades.mean():.2f}")
# ì¶œë ¥: ì „ì²´ í‰ê· : 87.87

print(f"ì „ì²´ ìµœê³ ì : {grades.max()}")
# ì¶œë ¥: ì „ì²´ ìµœê³ ì : 95.0

print(f"ì „ì²´ ìµœì €ì : {grades.min()}")
# ì¶œë ¥: ì „ì²´ ìµœì €ì : 78.0

print(f"ì „ì²´ í•©ê³„: {grades.sum()}")
# ì¶œë ¥: ì „ì²´ í•©ê³„: 1318.0
```

### í†µê³„ì  ì§‘ê³„ í•¨ìˆ˜
```python
# í‘œì¤€í¸ì°¨ì™€ ë¶„ì‚°
print(f"í‘œì¤€í¸ì°¨: {grades.std():.2f}")
# ì¶œë ¥: í‘œì¤€í¸ì°¨: 4.89

print(f"ë¶„ì‚°: {grades.var():.2f}")
# ì¶œë ¥: ë¶„ì‚°: 23.92

# ì¤‘ì•™ê°’ê³¼ ë¶„ìœ„ìˆ˜
print(f"ì¤‘ì•™ê°’: {grades.median()}")
# ì¶œë ¥: ì¤‘ì•™ê°’: 88.0

print(f"75% ë¶„ìœ„ìˆ˜: {grades.quantile(0.75)}")
# ì¶œë ¥: 75% ë¶„ìœ„ìˆ˜: 91.0
```

---

## ğŸ“ ì°¨ì›ë³„ ì§‘ê³„ ì—°ì‚°

`dim` íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ë©´ íŠ¹ì • ì°¨ì›ì„ ë”°ë¼ ì§‘ê³„ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. ì´ëŠ” ë”¥ëŸ¬ë‹ì—ì„œ ë°°ì¹˜ í†µê³„, ì±„ë„ë³„ ì •ê·œí™” ë“±ì— í•„ìˆ˜ì ì´ë‹¤.

![ì°¨ì›ë³„ ì§‘ê³„ ì‹œê°í™”]
*[ì´ë¯¸ì§€ ìœ„ì¹˜: 2D í…ì„œì—ì„œ dim=0ê³¼ dim=1ì˜ ì°¨ì´ë¥¼ ë³´ì—¬ì£¼ëŠ” í™”ì‚´í‘œ ë‹¤ì´ì–´ê·¸ë¨]*

### dim íŒŒë¼ë¯¸í„°ì˜ ì´í•´
```python
# 3x4 í–‰ë ¬ ìƒì„±
mat = torch.arange(12).reshape(3, 4)
print("ì›ë³¸ í–‰ë ¬:")
print(mat)
# ì¶œë ¥: ì›ë³¸ í–‰ë ¬:
#       tensor([[ 0,  1,  2,  3],
#               [ 4,  5,  6,  7],
#               [ 8,  9, 10, 11]])

# dim=0: í–‰ ë°©í–¥ìœ¼ë¡œ ì§‘ê³„ (ì„¸ë¡œ ë°©í–¥)
print("\ndim=0 ì§‘ê³„ (ê° ì—´ì˜ í•©):")
print(mat.sum(dim=0))
# ì¶œë ¥: dim=0 ì§‘ê³„ (ê° ì—´ì˜ í•©):
#       tensor([12, 15, 18, 21])

# dim=1: ì—´ ë°©í–¥ìœ¼ë¡œ ì§‘ê³„ (ê°€ë¡œ ë°©í–¥)  
print("\ndim=1 ì§‘ê³„ (ê° í–‰ì˜ í•©):")
print(mat.sum(dim=1))
# ì¶œë ¥: dim=1 ì§‘ê³„ (ê° í–‰ì˜ í•©):
#       tensor([ 6, 22, 38])
```

### í•™ìƒ ì„±ì  ì˜ˆì œë¡œ ì´í•´í•˜ê¸°
```python
# ë‹¤ì‹œ ì„±ì í‘œ ì˜ˆì œ ì‚¬ìš©
print("ì„±ì í‘œ shape:", grades.shape)  # [5 í•™ìƒ, 3 ê³¼ëª©]
# ì¶œë ¥: ì„±ì í‘œ shape: torch.Size([5, 3])

# ê³¼ëª©ë³„ í‰ê·  (dim=0: í•™ìƒ ì°¨ì›ì„ ë”°ë¼)
subj_avg = grades.mean(dim=0)
print(f"ê³¼ëª©ë³„ í‰ê· : {subj_avg}")
# ì¶œë ¥: ê³¼ëª©ë³„ í‰ê· : tensor([86.6000, 88.2000, 89.0000])

# í•™ìƒë³„ í‰ê·  (dim=1: ê³¼ëª© ì°¨ì›ì„ ë”°ë¼)
stud_avg = grades.mean(dim=1)
print(f"í•™ìƒë³„ í‰ê· : {stud_avg}")
# ì¶œë ¥: í•™ìƒë³„ í‰ê· : tensor([87.6667, 91.6667, 81.6667, 91.0000, 87.6667])
```

### maxì™€ minì˜ íŠ¹ë³„í•œ ë°˜í™˜ê°’
```python
# maxì™€ minì€ ê°’ê³¼ ì¸ë±ìŠ¤ë¥¼ í•¨ê»˜ ë°˜í™˜
print("\nê³¼ëª©ë³„ ìµœê³ ì ê³¼ í•´ë‹¹ í•™ìƒ ì¸ë±ìŠ¤:")
max_vals, max_idx = grades.max(dim=0)
print(f"ìµœê³ ì : {max_vals}")
# ì¶œë ¥: ìµœê³ ì : tensor([92., 92., 95.])

print(f"í•™ìƒ ì¸ë±ìŠ¤: {max_idx}")
# ì¶œë ¥: í•™ìƒ ì¸ë±ìŠ¤: tensor([1, 3, 1])

print("\ní•™ìƒë³„ ìµœê³  ê³¼ëª©:")
max_vals, max_idx = grades.max(dim=1)
print(f"ìµœê³ ì : {max_vals}")
# ì¶œë ¥: ìµœê³ ì : tensor([90., 95., 85., 92., 89.])

print(f"ê³¼ëª© ì¸ë±ìŠ¤: {max_idx}")
# ì¶œë ¥: ê³¼ëª© ì¸ë±ìŠ¤: tensor([1, 2, 1, 1, 2])
```

---

## ğŸ”„ ë‹¤ì¤‘ ì°¨ì› ì§‘ê³„

ì—¬ëŸ¬ ì°¨ì›ì„ ë™ì‹œì— ì§‘ê³„í•  ìˆ˜ ìˆë‹¤. ì´ëŠ” ê³ ì°¨ì› í…ì„œë¥¼ ë‹¤ë£° ë•Œ íŠ¹íˆ ìœ ìš©í•˜ë‹¤.

### 3D í…ì„œ ì˜ˆì œ
```python
# 3D í…ì„œ: 2ê°œ ë°˜, 4ëª… í•™ìƒ, 3ê³¼ëª©
class_scores = torch.arange(24).reshape(2, 4, 3)
print("ë°˜ë³„ ì„±ì  ë°ì´í„°:")
print(class_scores)
# ì¶œë ¥: ë°˜ë³„ ì„±ì  ë°ì´í„°:
#       tensor([[[ 0,  1,  2],
#                [ 3,  4,  5],
#                [ 6,  7,  8],
#                [ 9, 10, 11]],
#               [[12, 13, 14],
#                [15, 16, 17],
#                [18, 19, 20],
#                [21, 22, 23]]])

# ê° ì°¨ì›ë³„ ì§‘ê³„
print(f"\nì›ë³¸ shape: {class_scores.shape}")
# ì¶œë ¥: ì›ë³¸ shape: torch.Size([2, 4, 3])

print(f"dim=0 sum shape: {class_scores.sum(dim=0).shape}")
# ì¶œë ¥: dim=0 sum shape: torch.Size([4, 3])

print("dim=0 sum (ë°˜ ì°¨ì› ì§‘ê³„):")
print(class_scores.sum(dim=0))
# ì¶œë ¥: dim=0 sum (ë°˜ ì°¨ì› ì§‘ê³„):
#       tensor([[12, 14, 16],
#               [18, 20, 22],
#               [24, 26, 28],
#               [30, 32, 34]])
```
<br/>

<div align="center">
  <img src="https://github.com/user-attachments/assets/936ac5f1-b3c8-4c2a-9253-1eade3a49ac8" width="1800">
</div>


### ë‹¤ì¤‘ ì°¨ì› ë™ì‹œ ì§‘ê³„
```python
# ì—¬ëŸ¬ ì°¨ì› ë™ì‹œ ì§‘ê³„
print("\ndim=(1,2) ì§‘ê³„ (ê° ë°˜ì˜ ì „ì²´ í•©):")
class_totals = class_scores.sum(dim=(1, 2))
print(class_totals)
# ì¶œë ¥: dim=(1,2) ì§‘ê³„ (ê° ë°˜ì˜ ì „ì²´ í•©):
#       tensor([ 66, 210])

# ìˆœì„œëŠ” ìƒê´€ì—†ìŒ
print("dim=(2,1) ì§‘ê³„ (ë™ì¼í•œ ê²°ê³¼):")
print(class_scores.sum(dim=(2, 1)))
# ì¶œë ¥: dim=(2,1) ì§‘ê³„ (ë™ì¼í•œ ê²°ê³¼):
#       tensor([ 66, 210])

# ìŒìˆ˜ ì¸ë±ìŠ¤ ì‚¬ìš©
print("\ndim=-1 ì§‘ê³„ (ë§ˆì§€ë§‰ ì°¨ì›):")
print(class_scores.sum(dim=-1))
# ì¶œë ¥: dim=-1 ì§‘ê³„ (ë§ˆì§€ë§‰ ì°¨ì›):
#       tensor([[ 3, 12, 21, 30],
#               [39, 48, 57, 66]])

print("\ndim=(-2,-1) ì§‘ê³„ (ë§ˆì§€ë§‰ ë‘ ì°¨ì›):")
print(class_scores.sum(dim=(-2, -1)))
# ì¶œë ¥: dim=(-2,-1) ì§‘ê³„ (ë§ˆì§€ë§‰ ë‘ ì°¨ì›):
#       tensor([ 66, 210])
```

### keepdim ì˜µì…˜
```python
# keepdim=Trueë¡œ ì°¨ì› ìœ ì§€
orig = torch.randn(3, 4, 5)
print(f"ì›ë³¸ shape: {orig.shape}")
# ì¶œë ¥: ì›ë³¸ shape: torch.Size([3, 4, 5])

# keepdim=False (ê¸°ë³¸ê°’)
reduced = orig.mean(dim=1)
print(f"keepdim=False: {reduced.shape}")
# ì¶œë ¥: keepdim=False: torch.Size([3, 5])

# keepdim=True
kept = orig.mean(dim=1, keepdim=True)
print(f"keepdim=True: {kept.shape}")
# ì¶œë ¥: keepdim=True: torch.Size([3, 1, 5])
```

---

## ğŸ¯ argmaxì™€ argmin í™œìš©

`argmax`ì™€ `argmin`ì€ ìµœëŒ€/ìµœì†Œê°’ì˜ ìœ„ì¹˜(ì¸ë±ìŠ¤)ë¥¼ ë°˜í™˜í•œë‹¤. ë¶„ë¥˜ ë¬¸ì œì—ì„œ ì˜ˆì¸¡ í´ë˜ìŠ¤ë¥¼ ì°¾ê±°ë‚˜, ê°€ì¥ ì¤‘ìš”í•œ íŠ¹ì§•ì„ ì„ íƒí•  ë•Œ í•„ìˆ˜ì ì´ë‹¤.

### ê¸°ë³¸ ì‚¬ìš©ë²•
```python
torch.manual_seed(2025)

# 1D í™•ë¥  ë¶„í¬
probs = torch.rand(10)
print(f"í™•ë¥  ë¶„í¬: {probs}")
# ì¶œë ¥: í™•ë¥  ë¶„í¬: tensor([0.1947, 0.9379, 0.0840, 0.4652, 0.7508, 0.9644, 0.8788, 0.0567,
#                        0.9274, 0.5426])

print(f"ìµœëŒ€ê°’: {probs.max():.4f}, ìœ„ì¹˜: {probs.argmax()}")
# ì¶œë ¥: ìµœëŒ€ê°’: 0.9644, ìœ„ì¹˜: 5

print(f"ìµœì†Œê°’: {probs.min():.4f}, ìœ„ì¹˜: {probs.argmin()}")
# ì¶œë ¥: ìµœì†Œê°’: 0.0567, ìœ„ì¹˜: 7
```

### ë¶„ë¥˜ ë¬¸ì œì—ì„œì˜ í™œìš©
```python
# 5ê°œ ìƒ˜í”Œ, 4ê°œ í´ë˜ìŠ¤ì˜ ë¡œì§“
logits = torch.randn(5, 4)
print("ë¶„ë¥˜ ë¡œì§“:")
print(logits)
# ì¶œë ¥: ë¶„ë¥˜ ë¡œì§“:
#       tensor([[ 0.3847, -0.6459,  1.2128, -0.3121],
#               [-0.8891,  0.7265,  0.1909, -1.5430],
#               [ 0.9061, -0.3742, -0.8321,  1.0216],
#               [-0.4639,  0.5442, -1.1524,  0.8927],
#               [ 1.3589, -0.7286, -0.2446,  0.5043]])

# ê° ìƒ˜í”Œì˜ ì˜ˆì¸¡ í´ë˜ìŠ¤
predictions = logits.argmax(dim=1)
print(f"ì˜ˆì¸¡ í´ë˜ìŠ¤: {predictions}")
# ì¶œë ¥: ì˜ˆì¸¡ í´ë˜ìŠ¤: tensor([2, 1, 3, 3, 0])

# Softmax í™•ë¥ ë¡œ ë³€í™˜ í›„ argmax
probs = torch.softmax(logits, dim=1)
print("\nSoftmax í™•ë¥ :")
print(probs)
# ì¶œë ¥: Softmax í™•ë¥ :
#       tensor([[0.2286, 0.0825, 0.5246, 0.1143],
#               [0.1029, 0.5199, 0.3037, 0.0536],
#               [0.3654, 0.1023, 0.0651, 0.4072],
#               [0.1208, 0.3376, 0.0616, 0.4800],
#               [0.5544, 0.0679, 0.1125, 0.2451]])

# í™•ë¥  ê¸°ë°˜ ì˜ˆì¸¡ (ë™ì¼í•œ ê²°ê³¼)
prob_predictions = probs.argmax(dim=1)
print(f"í™•ë¥  ê¸°ë°˜ ì˜ˆì¸¡: {prob_predictions}")
# ì¶œë ¥: í™•ë¥  ê¸°ë°˜ ì˜ˆì¸¡: tensor([2, 1, 3, 3, 0])
```

### top-k ê°’ ì°¾ê¸°
```python
# ìƒìœ„ kê°œ ê°’ê³¼ ì¸ë±ìŠ¤ ì°¾ê¸°
values = torch.randn(10)
print(f"ì›ë³¸ ê°’: {values}")
# ì¶œë ¥: ì›ë³¸ ê°’: tensor([-0.3456,  1.2345, -0.7890,  2.3456,  0.1234, -1.5678,  0.9876,
#                      1.8765, -0.4567,  0.5678])

# ìƒìœ„ 3ê°œ
top3_vals, top3_idx = torch.topk(values, k=3)
print(f"ìƒìœ„ 3ê°œ ê°’: {top3_vals}")
# ì¶œë ¥: ìƒìœ„ 3ê°œ ê°’: tensor([2.3456, 1.8765, 1.2345])

print(f"ìƒìœ„ 3ê°œ ì¸ë±ìŠ¤: {top3_idx}")
# ì¶œë ¥: ìƒìœ„ 3ê°œ ì¸ë±ìŠ¤: tensor([3, 7, 1])

# í•˜ìœ„ 3ê°œ (largest=False)
bottom3_vals, bottom3_idx = torch.topk(values, k=3, largest=False)
print(f"í•˜ìœ„ 3ê°œ ê°’: {bottom3_vals}")
# ì¶œë ¥: í•˜ìœ„ 3ê°œ ê°’: tensor([-1.5678, -0.7890, -0.4567])

print(f"í•˜ìœ„ 3ê°œ ì¸ë±ìŠ¤: {bottom3_idx}")
# ì¶œë ¥: í•˜ìœ„ 3ê°œ ì¸ë±ìŠ¤: tensor([5, 2, 8])
```

---

## ğŸ’¼ ì‹¤ì „ í™œìš© ì˜ˆì œ

### 1. ë°°ì¹˜ ì •ê·œí™” í†µê³„ ê³„ì‚°
```python
# ë¯¸ë‹ˆë°°ì¹˜ ì •ê·œí™”ë¥¼ ìœ„í•œ í†µê³„ ê³„ì‚°
# [ë°°ì¹˜, ì±„ë„, ë†’ì´, ë„ˆë¹„] í˜•íƒœì˜ ì´ë¯¸ì§€ ë°ì´í„°
batch_imgs = torch.randn(32, 3, 64, 64)

# ì±„ë„ë³„ í‰ê· ê³¼ í‘œì¤€í¸ì°¨ ê³„ì‚° (ë°°ì¹˜, ë†’ì´, ë„ˆë¹„ì— ëŒ€í•´)
channel_mean = batch_imgs.mean(dim=(0, 2, 3), keepdim=True)
channel_std = batch_imgs.std(dim=(0, 2, 3), keepdim=True)

print(f"ì›ë³¸ shape: {batch_imgs.shape}")
# ì¶œë ¥: ì›ë³¸ shape: torch.Size([32, 3, 64, 64])

print(f"ì±„ë„ë³„ í‰ê·  shape: {channel_mean.shape}")
# ì¶œë ¥: ì±„ë„ë³„ í‰ê·  shape: torch.Size([1, 3, 1, 1])

print(f"ì±„ë„ë³„ í‰ê· ê°’: {channel_mean.squeeze()}")
# ì¶œë ¥: ì±„ë„ë³„ í‰ê· ê°’: tensor([-0.0012,  0.0023, -0.0008])

# ì •ê·œí™” ì ìš©
normalized = (batch_imgs - channel_mean) / (channel_std + 1e-5)
```

### 2. ì–´í…ì…˜ ìŠ¤ì½”ì–´ì—ì„œ ìµœëŒ€ê°’ ì°¾ê¸°
```python
# ì–´í…ì…˜ ìŠ¤ì½”ì–´ í–‰ë ¬
attn_scores = torch.randn(8, 12, 100, 100)  # [ë°°ì¹˜, í—¤ë“œ, ì‹œí€€ìŠ¤, ì‹œí€€ìŠ¤]

# ê° ìœ„ì¹˜ì—ì„œ ê°€ì¥ ì£¼ëª©í•˜ëŠ” ìœ„ì¹˜ ì°¾ê¸°
max_attn_idx = attn_scores.argmax(dim=-1)
print(f"ìµœëŒ€ ì–´í…ì…˜ ìœ„ì¹˜ shape: {max_attn_idx.shape}")
# ì¶œë ¥: ìµœëŒ€ ì–´í…ì…˜ ìœ„ì¹˜ shape: torch.Size([8, 12, 100])

# ì–´í…ì…˜ ê°•ë„ í†µê³„
attn_mean = attn_scores.mean(dim=(2, 3))
attn_max = attn_scores.max(dim=(2, 3))[0]
print(f"í—¤ë“œë³„ í‰ê·  ì–´í…ì…˜: {attn_mean.shape}")
# ì¶œë ¥: í—¤ë“œë³„ í‰ê·  ì–´í…ì…˜: torch.Size([8, 12])
```

### 3. ì†ì‹¤ í•¨ìˆ˜ì—ì„œì˜ ì§‘ê³„
```python
# ë°°ì¹˜ì˜ ê°œë³„ ì†ì‹¤ê°’ë“¤
individual_losses = torch.rand(128)  # 128ê°œ ìƒ˜í”Œì˜ ì†ì‹¤

# ë‹¤ì–‘í•œ ì§‘ê³„ ë°©ë²•
mean_loss = individual_losses.mean()
sum_loss = individual_losses.sum()
max_loss = individual_losses.max()

print(f"í‰ê·  ì†ì‹¤: {mean_loss:.4f}")
# ì¶œë ¥: í‰ê·  ì†ì‹¤: 0.4987

print(f"ì´ ì†ì‹¤: {sum_loss:.4f}")
# ì¶œë ¥: ì´ ì†ì‹¤: 63.8336

print(f"ìµœëŒ€ ì†ì‹¤: {max_loss:.4f}")
# ì¶œë ¥: ìµœëŒ€ ì†ì‹¤: 0.9934

# ìƒìœ„ 10% ì–´ë ¤ìš´ ìƒ˜í”Œë“¤ì˜ í‰ê·  ì†ì‹¤ (Hard negative mining)
k = int(0.1 * len(individual_losses))
hard_losses, _ = torch.topk(individual_losses, k)
hard_mean = hard_losses.mean()
print(f"ìƒìœ„ 10% ì–´ë ¤ìš´ ìƒ˜í”Œ í‰ê·  ì†ì‹¤: {hard_mean:.4f}")
# ì¶œë ¥: ìƒìœ„ 10% ì–´ë ¤ìš´ ìƒ˜í”Œ í‰ê·  ì†ì‹¤: 0.9523
```

---

## ğŸ“Š í•¨ìˆ˜ë³„ ìš”ì•½

| í•¨ìˆ˜ | ìš©ë„ | ë°˜í™˜ê°’ | ì£¼ìš” ì˜µì…˜ |
|------|------|--------|----------|
| `sum` | í•©ê³„ | í…ì„œ | dim, keepdim |
| `mean` | í‰ê·  | í…ì„œ | dim, keepdim, dtype |
| `max/min` | ìµœëŒ€/ìµœì†Œ | (ê°’, ì¸ë±ìŠ¤) | dim, keepdim |
| `std/var` | í‘œì¤€í¸ì°¨/ë¶„ì‚° | í…ì„œ | dim, keepdim, unbiased |
| `argmax/argmin` | ìµœëŒ€/ìµœì†Œ ì¸ë±ìŠ¤ | ì¸ë±ìŠ¤ í…ì„œ | dim, keepdim |
| `topk` | ìƒìœ„ kê°œ | (ê°’, ì¸ë±ìŠ¤) | k, dim, largest |

ì§‘ê³„ ì—°ì‚°ì€ ë”¥ëŸ¬ë‹ì˜ ëª¨ë“  ë‹¨ê³„ì—ì„œ ì‚¬ìš©ë˜ëŠ” í•µì‹¬ ê¸°ëŠ¥ì´ë‹¤. ì´ ê°€ì´ë“œë¥¼ í†µí•´ ë‹¤ì–‘í•œ ìƒí™©ì—ì„œ ì ì ˆí•œ ì§‘ê³„ í•¨ìˆ˜ë¥¼ ì„ íƒí•˜ê³  í™œìš©í•  ìˆ˜ ìˆê¸°ë¥¼ ë°”ë€ë‹¤!
